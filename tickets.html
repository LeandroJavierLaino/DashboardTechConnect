<!DOCTYPE html>
<html>
<style type="text/css">
	html, body, div, iframe { margin:0; padding:0; height:100%; }
	iframe { display:block; width:100%; border:none; }
	th, td { border-bottom: 1px solid #ddd; text-align: left;}
	tr:nth-child(even) {background-color: #f2f2f2}
	tr:nth-child(odd) {background-color: #f6f6f6}
	table {text-align:center; border-collapse: collapse; font-family: arial;white-space: nowrap;}
	.headTable{ font-weight: bold;}
	tr:hover{background-color: #9999ff}
</style>
<script src="xls.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
<script src="shim.js"></script>
<head>
	<title>Tickets</title>
</head>
<body scrolling="yes">
<div>
	<div>
		<script type="text/javascript">
		var oFileIn;

		$(function() {
		    oFileIn = document.getElementById('my_file_input');
		    if(oFileIn.addEventListener) {
		        oFileIn.addEventListener('change', filePicked, false);
		    }
		});


		function filePicked(oEvent) {
		    // Get The File From The Input
		    var oFile = oEvent.target.files[0];
		    var sFilename = oFile.name;
		    // Create A File Reader HTML5
		    var reader = new FileReader();
		    
		    // Ready The Event For When A File Gets Selected
		    reader.onload = function(e) {
		        var data = e.target.result;
		        var cfb = XLS.CFB.read(data, {type: 'binary'});
		        var wb = XLS.parse_xlscfb(cfb);
		        // Loop Over Each Sheet
		        wb.SheetNames.forEach(function(sheetName) {
		            // Obtain The Current Row As CSV
		            var sCSV = XLS.utils.make_csv(wb.Sheets[sheetName]);   
		            var data = XLS.utils.sheet_to_json(wb.Sheets[sheetName], {header:1});   
		            $.each(data, function( indexR, valueR ) {
		                var sRow = "<tr>";
		                if( indexR == 0 ){
		                	$.each(data[indexR], function( indexC, valueC ) {
		                  	  sRow = sRow + "<td class='headTable'  style='align-text:center'>" + valueC +"</td>";
		                	});                
		                }
		                else{
		                $.each(data[indexR], function( indexC, valueC ) {
		                    sRow = sRow + "<td>" + valueC + "</td>";
		                });
		                sRow = sRow + "</tr>";
		                }
		                $("#my_file_output").append(sRow);
		            });
		        });
		    };
		    
		    // Tell JS To Start Reading The File.. You could delay this if desired
		    reader.readAsBinaryString(oFile);
		}
		</script>
		<script>
			function filtro() {
			  // Declare variables 
			  var input, filter, table, tr, td, i;
			  input = document.getElementById("tecnico");
			  filter = input.value.toUpperCase();
			  table = document.getElementById("my_file_output");
			  tr = table.getElementsByTagName("tr");

			  // Loop through all table rows, and hide those who don't match the search query
			  for (i = 1; i < tr.length; i++) {
			    td = tr[i].getElementsByTagName("td")[9];
			    if (td) {
			      if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
			        tr[i].style.display = "";
			      } else {
			        tr[i].style.display = "none";
			      }
			    } 
			  }
			}
		</script>
		<input type="file" id="my_file_input" />
		<input type="text" id="tecnico" onkeyup="filtro()" placeholder="Filtro por Tecnico ...">
		<table id='my_file_output' ></table>
	</div>
</div>
</body>

</html>